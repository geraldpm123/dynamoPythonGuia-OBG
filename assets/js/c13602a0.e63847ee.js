"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[6613],{7607:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>l,contentTitle:()=>s,default:()=>p,frontMatter:()=>i,metadata:()=>c,toc:()=>t});var a=n(4848),o=n(8453);n(2364);const i={sidebar_position:7},s="7. Interoperabilidad Excel con Python",c={id:"DynamoPython/RevitAPI/07InteroperabilidadExcel",title:"7. Interoperabilidad Excel con Python",description:"Usar Excel con Python es una tarea com\xfan y \xfatil para automatizar la manipulaci\xf3n de datos,",source:"@site/docs/02-DynamoPython/03-RevitAPI/07InteroperabilidadExcel.mdx",sourceDirName:"02-DynamoPython/03-RevitAPI",slug:"/DynamoPython/RevitAPI/07InteroperabilidadExcel",permalink:"/dynamoPythonGuia-OBG/docs/DynamoPython/RevitAPI/07InteroperabilidadExcel",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/02-DynamoPython/03-RevitAPI/07InteroperabilidadExcel.mdx",tags:[],version:"current",sidebarPosition:7,frontMatter:{sidebar_position:7},sidebar:"guiaDynamoAvanzado",previous:{title:"6. Ejemplos B\xe1sicos",permalink:"/dynamoPythonGuia-OBG/docs/DynamoPython/RevitAPI/06EjemplosBasicos"},next:{title:"8. Geometry Conversion",permalink:"/dynamoPythonGuia-OBG/docs/DynamoPython/RevitAPI/08GeometryConversion"}},l={},t=[{value:"7.1. Interoperabilidad de COM para IronPython",id:"71-interoperabilidad-de-com-para-ironpython",level:2},{value:"7.2. Ejemplos Practicos",id:"72-ejemplos-practicos",level:2},{value:"7.3. Ejercicios Propuestos",id:"73-ejercicios-propuestos",level:2}];function d(e){const r={code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components},{Details:n}=r;return n||function(e,r){throw new Error("Expected "+(r?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.h1,{id:"7-interoperabilidad-excel-con-python",children:"7. Interoperabilidad Excel con Python"}),"\n",(0,a.jsxs)(r.p,{children:["Usar Excel con Python es una tarea com\xfan y \xfatil para automatizar la manipulaci\xf3n de datos,\r\ngeneraci\xf3n de reportes y otras operaciones. Puedes usar bibliotecas como ",(0,a.jsx)(r.code,{children:"openpyxl"})," para interactuar\r\ncon archivos Excel."]}),"\n",(0,a.jsx)(r.h2,{id:"71-interoperabilidad-de-com-para-ironpython",children:"7.1. Interoperabilidad de COM para IronPython"}),"\n",(0,a.jsx)(r.p,{children:"En el caso de IronPython podemos usar la Interoperabilidad de COM (Component Object Model).\r\nEsto implica usar la biblioteca COM de Excel para abrir, modificar y guardar archivos Excel\r\ndirectamente desde IronPython, pero debemos tener instalado Excel para poder usarlo."}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-python",children:'import clr\r\nclr.AddReference("Microsoft.Office.Interop.Excel")\r\nfrom Microsoft.Office.Interop import Excel\n'})}),"\n",(0,a.jsx)(r.p,{children:"A continuacion se muestra ejemplos completos para crear un archivo de excel:"}),"\n",(0,a.jsxs)(n,{children:[(0,a.jsx)("summary",{children:(0,a.jsx)(r.strong,{children:"Ejemplo: Crear un archivo Excel"})}),(0,a.jsx)(r.p,{children:"En este ejemplo se muestra como crear un archivo Excel usando la Interoperabilidad COM"}),(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-py",children:'import clr\r\nclr.AddReference(\'Microsoft.Office.Interop.Excel\')\r\nfrom Microsoft.Office.Interop import Excel\r\n\r\n# Ingreso de la ruta de guardado\r\nruta = IN[0]\r\n\r\n# Crear una instancia de la aplicaci\xf3n Excel\r\nexcel = Excel.ApplicationClass()\r\n\r\n# Hacer visible la aplicaci\xf3n (opcional)\r\nexcel.Visible = True\r\n\r\n# Crear un nuevo libro de trabajo\r\nworkbook = excel.Workbooks.Add()\r\n\r\n# Seleccionar la primera hoja\r\nsheet = workbook.Worksheets[1]\r\n\r\n# Llenar una celda espec\xedfica, por ejemplo, A1 con el valor "Hola Dynamo"\r\nsheet.Cells[1, 1].Value2 = "Hola Dynamo"\r\n\r\n# Guardar el archivo de Excel\r\nworkbook.SaveAs(ruta)\r\n\r\n# Cerrar el libro de trabajo (opcional)\r\nworkbook.Close(SaveChanges=True)\r\n\r\n# Cerrar la aplicaci\xf3n Excel (opcional)\r\nexcel.Quit()\n'})})]}),"\n",(0,a.jsxs)(n,{children:[(0,a.jsx)("summary",{children:(0,a.jsx)(r.strong,{children:"Ejemplo: Crear un archivo Excel con Formula"})}),(0,a.jsx)(r.p,{children:"En este ejemplo se muestra como crear un archivo Excel con una formula en una celda"}),(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-py",children:"import clr\r\nclr.AddReference('Microsoft.Office.Interop.Excel')\r\nfrom Microsoft.Office.Interop import Excel\r\n\r\nruta = IN[0]\r\n\r\n# Crear una instancia de la aplicaci\xf3n Excel\r\nexcel = Excel.ApplicationClass()\r\n\r\n# Hacer visible la aplicaci\xf3n (opcional)\r\nexcel.Visible = False\r\n\r\n# Crear un nuevo libro de trabajo\r\nworkbook = excel.Workbooks.Add()\r\n\r\n# Seleccionar la primera hoja\r\nsheet = workbook.Worksheets[1]\r\n\r\n# Llenar algunas celdas con datos\r\nsheet.Cells[1, 1].Value2 = 5  # A1\r\nsheet.Cells[1, 2].Value2 = 10  # B1\r\n\r\n# Establecer una f\xf3rmula en una celda espec\xedfica, por ejemplo, C1\r\nsheet.Cells[1, 3].Formula = \"=A1+B1\"\r\n\r\n# Guardar el archivo de Excel\r\nworkbook.SaveAs(ruta)\r\n\r\n# Cerrar el libro de trabajo (opcional)\r\nworkbook.Close(SaveChanges=True)\r\n\r\n# Cerrar la aplicaci\xf3n Excel (opcional)\r\nexcel.Quit()\n"})})]}),"\n",(0,a.jsxs)(n,{children:[(0,a.jsx)("summary",{children:(0,a.jsx)(r.strong,{children:"Ejemplo: Crear un archivo Excel con Imagenes"})}),(0,a.jsx)(r.p,{children:"En este ejemplo se muestra como crear un archivo Excel con una formula en una celda"}),(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-py",children:"import clr\r\nclr.AddReference('Microsoft.Office.Interop.Excel')\r\n\r\nfrom Microsoft.Office.Interop import Excel\r\n\r\nrutaExcel = IN[0]\r\nimage_path = IN[1]\r\n\r\n# Crear una instancia de la aplicaci\xf3n Excel\r\nexcel = Excel.ApplicationClass()\r\n\r\n# Hacer visible la aplicaci\xf3n (opcional)\r\nexcel.Visible = False\r\n\r\n# Crear un nuevo libro de trabajo\r\nworkbook = excel.Workbooks.Add()\r\n\r\n# Seleccionar la primera hoja\r\nsheet = workbook.Worksheets[1]\r\n\r\n\r\n# Insertar la imagen\r\n# Los par\xe1metros son (Filename, Left, Top, Width, Height)\r\nleft = sheet.Cells[1, 1].Left  # La posici\xf3n izquierda de la celda A1\r\ntop = sheet.Cells[1, 1].Top    # La posici\xf3n superior de la celda A1\r\nsheet.Shapes.AddPicture(image_path, 0, 1, left, top, -1, -1)\r\n\r\n# Guardar el archivo de Excel\r\nworkbook.SaveAs(rutaExcel)\r\n\r\n# Cerrar el libro de trabajo (opcional)\r\nworkbook.Close(SaveChanges=True)\r\n\r\n# Cerrar la aplicaci\xf3n Excel (opcional)\r\nexcel.Quit()\n"})})]}),"\n",(0,a.jsx)(r.h2,{id:"72-ejemplos-practicos",children:"7.2. Ejemplos Practicos"}),"\n",(0,a.jsx)(r.p,{children:"A continuacion se muestran algunos ejemplos para desarrollar en Clase."}),"\n",(0,a.jsxs)(n,{children:[(0,a.jsx)("summary",{children:(0,a.jsx)(r.strong,{children:"Ejemplo: Exportar Vista de Revit como Imagen"})}),(0,a.jsx)(r.p,{children:"En este ejemplo se muestra como exportar una imagen a partir de una vista"}),(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-py",children:"import clr\r\n\r\n#Import Revit API\r\nclr.AddReference('RevitAPI')\r\nfrom Autodesk.Revit.DB import *\r\n\r\n#import Document Manager and TransactionManager\r\nclr.AddReference(\"RevitServices\")\r\nimport RevitServices\r\nfrom RevitServices.Persistence import DocumentManager\r\nfrom RevitServices.Transactions import TransactionManager\r\n\r\n#Principales variables que tal vez usemos\r\ndoc = DocumentManager.Instance.CurrentDBDocument\r\n\r\noutput_path = IN[0]\r\n# Configurar las opciones de exportaci\xf3n\r\nimage_options = ImageExportOptions()\r\nimage_options.ExportRange = ExportRange.CurrentView\r\nimage_options.FilePath = output_path\r\nimage_options.HLRandWFViewsFileType = ImageFileType.PNG\r\nimage_options.ImageResolution = ImageResolution.DPI_300\r\n\r\nTransactionManager.Instance.EnsureInTransaction(doc)\r\n# Exportar la vista como imagen\r\ndoc.ExportImage(image_options)\r\nTransactionManager.Instance.TransactionTaskDone()\r\n\r\nOUT = 0\n"})})]}),"\n",(0,a.jsxs)(n,{children:[(0,a.jsx)("summary",{children:(0,a.jsx)(r.strong,{children:"Ejemplo: Obtener los Warnings del proyecto"})}),(0,a.jsx)(r.p,{children:"En este ejemplo se muestra como obtener los warnings del proyecto"}),(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-py",children:"import clr\r\n\r\nclr.AddReference('RevitAPI')\r\nfrom Autodesk.Revit.DB import *\r\n\r\nclr.AddReference(\"RevitServices\")\r\nimport RevitServices\r\nfrom RevitServices.Persistence import DocumentManager\r\nfrom RevitServices.Transactions import TransactionManager\r\n\r\n#Principales variables que tal vez usemos\r\ndoc = DocumentManager.Instance.CurrentDBDocument\r\n\r\n# Obtener todos los warnings del documento\r\nfailure_messages = doc.GetWarnings()\r\nmensajesWarning = []\r\nelementosDeWarnings = []\r\n# Iterar sobre cada warning\r\nfor failure_message in failure_messages:\r\n  # Obtener el texto del warning\r\n  warning_text = failure_message.GetDescriptionText()\r\n  mensajesWarning.append(warning_text)\r\n  # Obtener los elementos que participan en el warning\r\n  failing_elements = failure_message.GetFailingElements()\r\n  listaElementos = [doc.GetElement(id) for id in failing_elements]\r\n  elementosDeWarnings.append(listaElementos)\r\n\r\nOUT = mensajesWarning, elementosDeWarnings\n"})})]}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsx)(r.li,{children:"Ejemplo de Exportacion de Warnings con imagen de cada warning a Excel, para desarrollar en clase."}),"\n",(0,a.jsx)(r.li,{children:"Ejemplo de creacion de Filtros en Revit y asignacion a vista."}),"\n"]}),"\n",(0,a.jsx)(r.h2,{id:"73-ejercicios-propuestos",children:"7.3. Ejercicios Propuestos"}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsx)(r.li,{children:"Crear un PythonScript que cree un encabezamiento para una hoja de Excel con bordes gruesos."}),"\n",(0,a.jsx)(r.li,{children:"Crear un PythonScript que exporte las nubes de revision de Revit a Excel, con su descripcion."}),"\n"]})]})}function p(e={}){const{wrapper:r}={...(0,o.R)(),...e.components};return r?(0,a.jsx)(r,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}}}]);